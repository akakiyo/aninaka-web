{"ast":null,"code":"import _asyncToGenerator from\"/Users/kiyo/private/aninaka/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/kiyo/private/aninaka/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/kiyo/private/aninaka/frontend/node_modules/@babel/runtime/regenerator/index.js\";import{useState,useCallback,useEffect}from\"react\";import{firebaseAuth}from\"../firebase\";var useFirebaseAuth=function useFirebaseAuth(){var _firebaseAuth$current,_firebaseAuth$current2,_firebaseAuth$current3;var _useState=useState(firebaseAuth.currentUser),_useState2=_slicedToArray(_useState,2),currentUser=_useState2[0],setCurrentUser=_useState2[1];var _useState3=useState(firebaseAuth===null||firebaseAuth===void 0?void 0:(_firebaseAuth$current=firebaseAuth.currentUser)===null||_firebaseAuth$current===void 0?void 0:(_firebaseAuth$current2=_firebaseAuth$current.multiFactor)===null||_firebaseAuth$current2===void 0?void 0:(_firebaseAuth$current3=_firebaseAuth$current2.user)===null||_firebaseAuth$current3===void 0?void 0:_firebaseAuth$current3.uid),_useState4=_slicedToArray(_useState3,2),userId=_useState4[0],setUserId=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isAuthenticated=_useState6[0],setIsAuthenticated=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];useEffect(function(){var isMounted=true;firebaseAuth.onAuthStateChanged(function(user){if(isMounted){if(user){user.getIdTokenResult(true).then(function(result){setIsAuthenticated(true);setCurrentUser(user);setIsLoading(false);});}else{setIsAuthenticated(false);setCurrentUser(\"\");setIsLoading(false);}}});return function(){isMounted=false;};},[]);var cleanUpAuthentication=function cleanUpAuthentication(){setIsAuthenticated(false);setCurrentUser(\"\");setIsLoading(true);};var signup=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email,password){var user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return firebaseAuth.createUserWithEmailAndPassword(email,password).catch(function(err){return alert(err);});case 2:user=_context.sent;return _context.abrupt(\"return\",user.user.multiFactor.user.uid);case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}(),[]);var login=useCallback(function(email,password){firebaseAuth.signInWithEmailAndPassword(email,password).catch(function(err){return alert(err);});},[]);var logout=useCallback(function(){firebaseAuth.signOut();cleanUpAuthentication();},[]);return{signup:signup,login:login,logout:logout,currentUser:currentUser,userId:userId,isAuthenticated:isAuthenticated,isLoading:isLoading};};export default useFirebaseAuth;","map":{"version":3,"sources":["/Users/kiyo/private/aninaka/frontend/src/auth/useFirebaseAuth.js"],"names":["useState","useCallback","useEffect","firebaseAuth","useFirebaseAuth","currentUser","setCurrentUser","multiFactor","user","uid","userId","setUserId","isAuthenticated","setIsAuthenticated","isLoading","setIsLoading","isMounted","onAuthStateChanged","getIdTokenResult","then","result","cleanUpAuthentication","signup","email","password","createUserWithEmailAndPassword","catch","err","alert","login","signInWithEmailAndPassword","logout","signOut"],"mappings":"iXAAA,OAASA,QAAT,CAAmBC,WAAnB,CAAgCC,SAAhC,KAAiD,OAAjD,CACA,OAASC,YAAT,KAA6B,aAA7B,CAEA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,yEAC5B,cAAsCJ,QAAQ,CAACG,YAAY,CAACE,WAAd,CAA9C,wCAAOA,WAAP,eAAoBC,cAApB,eACA,eAA4BN,QAAQ,CAClCG,YADkC,SAClCA,YADkC,wCAClCA,YAAY,CAAEE,WADoB,wEAClC,sBAA2BE,WADO,yEAClC,uBAAwCC,IADN,iDAClC,uBAA8CC,GADZ,CAApC,yCAAOC,MAAP,eAAeC,SAAf,eAIA,eAA8CX,QAAQ,CAAC,KAAD,CAAtD,yCAAOY,eAAP,eAAwBC,kBAAxB,eACA,eAAkCb,QAAQ,CAAC,IAAD,CAA1C,yCAAOc,SAAP,eAAkBC,YAAlB,eAEAb,SAAS,CAAC,UAAM,CACd,GAAIc,CAAAA,SAAS,CAAG,IAAhB,CACAb,YAAY,CAACc,kBAAb,CAAgC,SAACT,IAAD,CAAU,CACxC,GAAIQ,SAAJ,CAAe,CACb,GAAIR,IAAJ,CAAU,CACRA,IAAI,CAACU,gBAAL,CAAsB,IAAtB,EAA4BC,IAA5B,CAAiC,SAACC,MAAD,CAAY,CAC3CP,kBAAkB,CAAC,IAAD,CAAlB,CACAP,cAAc,CAACE,IAAD,CAAd,CACAO,YAAY,CAAC,KAAD,CAAZ,CACD,CAJD,EAKD,CAND,IAMO,CACLF,kBAAkB,CAAC,KAAD,CAAlB,CACAP,cAAc,CAAC,EAAD,CAAd,CACAS,YAAY,CAAC,KAAD,CAAZ,CACD,CACF,CACF,CAdD,EAgBA,MAAO,WAAM,CACXC,SAAS,CAAG,KAAZ,CACD,CAFD,CAGD,CArBQ,CAqBN,EArBM,CAAT,CAuBA,GAAMK,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,EAAM,CAClCR,kBAAkB,CAAC,KAAD,CAAlB,CACAP,cAAc,CAAC,EAAD,CAAd,CACAS,YAAY,CAAC,IAAD,CAAZ,CACD,CAJD,CAMA,GAAMO,CAAAA,MAAM,CAAGrB,WAAW,0FAAC,iBAAOsB,KAAP,CAAcC,QAAd,iJACNrB,CAAAA,YAAY,CAC5BsB,8BADgB,CACeF,KADf,CACsBC,QADtB,EAEhBE,KAFgB,CAEV,SAACC,GAAD,QAASC,CAAAA,KAAK,CAACD,GAAD,CAAd,EAFU,CADM,QACnBnB,IADmB,+CAIlBA,IAAI,CAACA,IAAL,CAAUD,WAAV,CAAsBC,IAAtB,CAA2BC,GAJT,wDAAD,mEAKvB,EALuB,CAA1B,CAOA,GAAMoB,CAAAA,KAAK,CAAG5B,WAAW,CAAC,SAACsB,KAAD,CAAQC,QAAR,CAAqB,CAC7CrB,YAAY,CACT2B,0BADH,CAC8BP,KAD9B,CACqCC,QADrC,EAEGE,KAFH,CAES,SAACC,GAAD,QAASC,CAAAA,KAAK,CAACD,GAAD,CAAd,EAFT,EAGD,CAJwB,CAItB,EAJsB,CAAzB,CAMA,GAAMI,CAAAA,MAAM,CAAG9B,WAAW,CAAC,UAAM,CAC/BE,YAAY,CAAC6B,OAAb,GACAX,qBAAqB,GACtB,CAHyB,CAGvB,EAHuB,CAA1B,CAKA,MAAO,CACLC,MAAM,CAANA,MADK,CAELO,KAAK,CAALA,KAFK,CAGLE,MAAM,CAANA,MAHK,CAIL1B,WAAW,CAAXA,WAJK,CAKLK,MAAM,CAANA,MALK,CAMLE,eAAe,CAAfA,eANK,CAOLE,SAAS,CAATA,SAPK,CAAP,CASD,CAjED,CAmEA,cAAeV,CAAAA,eAAf","sourcesContent":["import { useState, useCallback, useEffect } from \"react\";\nimport { firebaseAuth } from \"../firebase\";\n\nconst useFirebaseAuth = () => {\n  const [currentUser, setCurrentUser] = useState(firebaseAuth.currentUser);\n  const [userId, setUserId] = useState(\n    firebaseAuth?.currentUser?.multiFactor?.user?.uid\n  );\n\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    let isMounted = true;\n    firebaseAuth.onAuthStateChanged((user) => {\n      if (isMounted) {\n        if (user) {\n          user.getIdTokenResult(true).then((result) => {\n            setIsAuthenticated(true);\n            setCurrentUser(user);\n            setIsLoading(false);\n          });\n        } else {\n          setIsAuthenticated(false);\n          setCurrentUser(\"\");\n          setIsLoading(false);\n        }\n      }\n    });\n\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  const cleanUpAuthentication = () => {\n    setIsAuthenticated(false);\n    setCurrentUser(\"\");\n    setIsLoading(true);\n  };\n\n  const signup = useCallback(async (email, password) => {\n    const user = await firebaseAuth\n      .createUserWithEmailAndPassword(email, password)\n      .catch((err) => alert(err));\n    return user.user.multiFactor.user.uid;\n  }, []);\n\n  const login = useCallback((email, password) => {\n    firebaseAuth\n      .signInWithEmailAndPassword(email, password)\n      .catch((err) => alert(err));\n  }, []);\n\n  const logout = useCallback(() => {\n    firebaseAuth.signOut();\n    cleanUpAuthentication();\n  }, []);\n\n  return {\n    signup,\n    login,\n    logout,\n    currentUser,\n    userId,\n    isAuthenticated,\n    isLoading,\n  };\n};\n\nexport default useFirebaseAuth;\n"]},"metadata":{},"sourceType":"module"}