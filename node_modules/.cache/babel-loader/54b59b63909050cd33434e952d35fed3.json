{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useCallback, useEffect } from \"react\";\nimport { firebaseAuth } from \"../../firebase\";\n\nconst useFirebaseAuth = () => {\n  _s();\n\n  const [currentUser, setCurrentUser] = useState(firebaseAuth.currentUser);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  console.log(\"currentUser\", currentUser);\n  useEffect(() => {\n    let unmounted = false;\n    firebaseAuth.onAuthStateChanged(user => {\n      if (user) {\n        user.getIdTokenResult(true).then(result => {\n          if (!unmounted) {\n            setIsAuthenticated(true);\n            setCurrentUser(user);\n            setIsLoading(false);\n          }\n        });\n      } else if (!unmounted) {\n        setIsAuthenticated(false);\n        setCurrentUser(\"\");\n        setIsLoading(false);\n      }\n    });\n    return () => {\n      unmounted = true;\n    };\n  }, []);\n\n  const cleanUpAuthentication = () => {\n    setIsAuthenticated(false);\n    setCurrentUser(\"\");\n    setIsLoading(true);\n  };\n\n  const signup = useCallback((email, password) => {\n    firebaseAuth.createUserWithEmailAndPassword(email, password).catch(err => alert(err));\n  }, []);\n  const login = useCallback((email, password) => {\n    firebaseAuth.signInWithEmailAndPassword(email, password).catch(err => alert(err));\n  }, []);\n  const logout = useCallback(() => {\n    firebaseAuth.signOut();\n    cleanUpAuthentication();\n  }, []);\n  return {\n    signup,\n    login,\n    logout,\n    currentUser,\n    isAuthenticated,\n    isLoading\n  };\n};\n\n_s(useFirebaseAuth, \"wzhxDZ/vN61+Omf2Tu3pcDTtvZk=\");\n\nexport default useFirebaseAuth;","map":{"version":3,"sources":["/Users/kiyo/private/aninaka/frontend/src/auth/useFirebaseAuth.js"],"names":["useState","useCallback","useEffect","firebaseAuth","useFirebaseAuth","currentUser","setCurrentUser","isAuthenticated","setIsAuthenticated","isLoading","setIsLoading","console","log","unmounted","onAuthStateChanged","user","getIdTokenResult","then","result","cleanUpAuthentication","signup","email","password","createUserWithEmailAndPassword","catch","err","alert","login","signInWithEmailAndPassword","logout","signOut"],"mappings":";;AAAA,SAASA,QAAT,EAAmBC,WAAnB,EAAgCC,SAAhC,QAAiD,OAAjD;AACA,SAASC,YAAT,QAA6B,gBAA7B;;AAEA,MAAMC,eAAe,GAAG,MAAM;AAAA;;AAC5B,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCN,QAAQ,CAACG,YAAY,CAACE,WAAd,CAA9C;AACA,QAAM,CAACE,eAAD,EAAkBC,kBAAlB,IAAwCR,QAAQ,CAAC,KAAD,CAAtD;AACA,QAAM,CAACS,SAAD,EAAYC,YAAZ,IAA4BV,QAAQ,CAAC,IAAD,CAA1C;AACAW,EAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BP,WAA3B;AACAH,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIW,SAAS,GAAG,KAAhB;AACAV,IAAAA,YAAY,CAACW,kBAAb,CAAiCC,IAAD,IAAU;AACxC,UAAIA,IAAJ,EAAU;AACRA,QAAAA,IAAI,CAACC,gBAAL,CAAsB,IAAtB,EAA4BC,IAA5B,CAAkCC,MAAD,IAAY;AAC3C,cAAI,CAACL,SAAL,EAAgB;AACdL,YAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAF,YAAAA,cAAc,CAACS,IAAD,CAAd;AACAL,YAAAA,YAAY,CAAC,KAAD,CAAZ;AACD;AACF,SAND;AAOD,OARD,MAQO,IAAI,CAACG,SAAL,EAAgB;AACrBL,QAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACAF,QAAAA,cAAc,CAAC,EAAD,CAAd;AACAI,QAAAA,YAAY,CAAC,KAAD,CAAZ;AACD;AACF,KAdD;AAgBA,WAAO,MAAM;AACXG,MAAAA,SAAS,GAAG,IAAZ;AACD,KAFD;AAGD,GArBQ,EAqBN,EArBM,CAAT;;AAuBA,QAAMM,qBAAqB,GAAG,MAAM;AAClCX,IAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACAF,IAAAA,cAAc,CAAC,EAAD,CAAd;AACAI,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACD,GAJD;;AAMA,QAAMU,MAAM,GAAGnB,WAAW,CAAC,CAACoB,KAAD,EAAQC,QAAR,KAAqB;AAC9CnB,IAAAA,YAAY,CACToB,8BADH,CACkCF,KADlC,EACyCC,QADzC,EAEGE,KAFH,CAEUC,GAAD,IAASC,KAAK,CAACD,GAAD,CAFvB;AAGD,GAJyB,EAIvB,EAJuB,CAA1B;AAMA,QAAME,KAAK,GAAG1B,WAAW,CAAC,CAACoB,KAAD,EAAQC,QAAR,KAAqB;AAC7CnB,IAAAA,YAAY,CACTyB,0BADH,CAC8BP,KAD9B,EACqCC,QADrC,EAEGE,KAFH,CAEUC,GAAD,IAASC,KAAK,CAACD,GAAD,CAFvB;AAGD,GAJwB,EAItB,EAJsB,CAAzB;AAMA,QAAMI,MAAM,GAAG5B,WAAW,CAAC,MAAM;AAC/BE,IAAAA,YAAY,CAAC2B,OAAb;AACAX,IAAAA,qBAAqB;AACtB,GAHyB,EAGvB,EAHuB,CAA1B;AAKA,SAAO;AACLC,IAAAA,MADK;AAELO,IAAAA,KAFK;AAGLE,IAAAA,MAHK;AAILxB,IAAAA,WAJK;AAKLE,IAAAA,eALK;AAMLE,IAAAA;AANK,GAAP;AAQD,CA3DD;;GAAML,e;;AA6DN,eAAeA,eAAf","sourcesContent":["import { useState, useCallback, useEffect } from \"react\";\nimport { firebaseAuth } from \"../../firebase\";\n\nconst useFirebaseAuth = () => {\n  const [currentUser, setCurrentUser] = useState(firebaseAuth.currentUser);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  console.log(\"currentUser\", currentUser);\n  useEffect(() => {\n    let unmounted = false;\n    firebaseAuth.onAuthStateChanged((user) => {\n      if (user) {\n        user.getIdTokenResult(true).then((result) => {\n          if (!unmounted) {\n            setIsAuthenticated(true);\n            setCurrentUser(user);\n            setIsLoading(false);\n          }\n        });\n      } else if (!unmounted) {\n        setIsAuthenticated(false);\n        setCurrentUser(\"\");\n        setIsLoading(false);\n      }\n    });\n\n    return () => {\n      unmounted = true;\n    };\n  }, []);\n\n  const cleanUpAuthentication = () => {\n    setIsAuthenticated(false);\n    setCurrentUser(\"\");\n    setIsLoading(true);\n  };\n\n  const signup = useCallback((email, password) => {\n    firebaseAuth\n      .createUserWithEmailAndPassword(email, password)\n      .catch((err) => alert(err));\n  }, []);\n\n  const login = useCallback((email, password) => {\n    firebaseAuth\n      .signInWithEmailAndPassword(email, password)\n      .catch((err) => alert(err));\n  }, []);\n\n  const logout = useCallback(() => {\n    firebaseAuth.signOut();\n    cleanUpAuthentication();\n  }, []);\n\n  return {\n    signup,\n    login,\n    logout,\n    currentUser,\n    isAuthenticated,\n    isLoading,\n  };\n};\n\nexport default useFirebaseAuth;\n"]},"metadata":{},"sourceType":"module"}